    <transition name="fade" mode="out-in" v-cloak>
        <div v-if="currentTab === 'jm_leaderboard'" class="space-y-6 pb-20">
            <div class="flex items-start justify-between gap-3">
                <div class="min-w-0">
                    <h2 class="text-2xl md:text-3xl font-bold flex items-center gap-3">
                        <span class="material-symbols-rounded text-primary">leaderboard</span>
                        JM 榜单
                    </h2>
                    <p class="text-sm opacity-60 mt-1">按分类与排序方式浏览</p>
                </div>
                <div class="flex items-center gap-2">
                    <button @click="loadJmLeaderboard(1)" :disabled="jmLeaderboardLoading"
                        class="w-10 h-10 rounded-full bg-surface-variant text-on-surface-variant flex items-center justify-center hover:bg-primary hover:text-on-primary transition disabled:opacity-40">
                        <span class="material-symbols-rounded" :class="jmLeaderboardLoading ? 'animate-spin' : ''">refresh</span>
                    </button>
                    <button @click="currentTab = 'home'"
                        class="w-10 h-10 rounded-full bg-surface-variant text-on-surface-variant flex items-center justify-center hover:bg-primary hover:text-on-primary transition">
                        <span class="material-symbols-rounded">arrow_back</span>
                    </button>
                </div>
            </div>

            <div class="md-card p-4 md:p-6 border border-outline/10 space-y-4">
                <div class="flex gap-2 overflow-x-auto max-w-full pb-2 no-scrollbar">
                    <button v-for="o in jmLeaderboardSortOptions" :key="o.value"
                        @click="setJmLeaderboardSort(o.value)"
                        class="h-10 px-4 rounded-full border text-sm font-medium transition whitespace-nowrap"
                        :class="jmLeaderboardSort === o.value ? 'bg-primary text-on-primary border-transparent shadow-md' : 'bg-surface text-on-surface border-outline/20 hover:bg-primary/10'">
                        {{ o.label }}
                    </button>
                </div>
                <div class="flex gap-2 overflow-x-auto max-w-full pb-2 no-scrollbar">
                    <button v-for="c in jmCategories" :key="String(c.CID || c.id || c.name || c.title || c)"
                        @click="setJmLeaderboardCategory(getJmCategoryId(c))"
                        class="h-10 px-4 rounded-full border text-sm font-medium transition whitespace-nowrap"
                        :class="jmLeaderboardCategory === getJmCategoryId(c) ? 'bg-primary text-on-primary border-transparent shadow-md' : 'bg-surface text-on-surface border-outline/20 hover:bg-primary/10'">
                        {{ getJmCategoryTitle(c) }}
                    </button>
                </div>
            </div>

            <loading-state :loading="jmLeaderboardLoading && jmLeaderboardItems.length === 0">
                <span class="mt-2 text-sm text-on-surface-variant">正在加载榜单...</span>
            </loading-state>

            <error-state :error="jmLeaderboardError" @retry="loadJmLeaderboard(1)"></error-state>

            <div v-if="!jmLeaderboardLoading && !jmLeaderboardError && jmLeaderboardItems.length === 0" class="flex flex-col items-center justify-center py-16 opacity-60">
                <span class="material-symbols-rounded text-6xl text-outline mb-3">leaderboard</span>
                <p class="font-medium text-on-surface-variant">暂无内容</p>
                <p class="text-xs mt-2">可尝试切换排序（如 日榜/周榜/月榜）或更换分类</p>
            </div>

            <div v-if="jmLeaderboardItems.length > 0" class="space-y-6">
                <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-3 md:gap-4">
                    <book-card 
                        v-for="book in jmLeaderboardItems" 
                        :key="book.album_id" 
                        :book="book" 
                        @click="viewDetails">
                    </book-card>
                </div>

                <div v-if="jmLeaderboardLoading && jmLeaderboardItems.length" class="flex items-center justify-center py-6 opacity-60">
                    <span class="material-symbols-rounded text-4xl animate-spin text-primary">progress_activity</span>
                </div>
                <div v-else-if="!jmLeaderboardHasMore" class="text-center text-xs opacity-60 py-4">没有更多了</div>

                <pagination-controls 
                    v-if="!jmLeaderboardLoading"
                    :page="jmLeaderboardPage" 
                    :loading="jmLeaderboardLoading" 
                    :has-more="jmLeaderboardHasMore"
                    @prev="loadJmLeaderboard(jmLeaderboardPage - 1)" 
                    @next="loadJmLeaderboard(jmLeaderboardPage + 1)">
                </pagination-controls>
            </div>
        </div>
    </transition>
